name: "Verification Check"

on:
  pull_request:
    types: [opened, edited, reopened, synchronize]

jobs:
  check-tested-locally:
    runs-on: ubuntu-latest
    steps:
      - name: Check for "Tested Locally" checkbox
        uses: actions/github-script@v6
        with:
          script: |
            const body = context.payload.pull_request.body || "";
            
            // Look for the specific pattern "[x] I have tested this code locally"
            // We use a regex to be flexible about whitespace
            const pattern = /-\s*\[x\]\s*I have tested this code locally/i;
            
            if (!pattern.test(body)) {
              core.setFailed("❌ You must check the box 'I have tested this code locally' in the PR description to merge.");
            } else {
              console.log("✅ Verification confirmed.");
            }
